<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="description" content="Vienna CAT Meetup #1" />
    <meta name="viewport" content="width=device-width" />
    <meta
      property="og:image"
      content="https://vienna-cat-meetup.pages.dev/vienna-cat-meetup.png"
    />
    <title>Vienna CAT Meetup #1</title>
    <style>
      * {
        box-sizing: border-box;
      }

      *::before,
      *::after {
        box-sizing: border-box;
      }

      :root {
        --background-color: #e7fff6;
        --foreground-color: #008080;
      }

      body {
        min-height: calc(100lvh - 2rem);
        display: grid;
        justify-content: center;
        grid-template-rows: 1fr min-content;
        gap: 4rem;
        padding: 2rem;

        background-color: var(--background-color);
        color: var(--foreground-color);
        font-family: sans-serif;
        font-size: 110%;
        line-height: 1.4;
      }

      h1 {
        max-width: 20ch;
        font-family: monospace;
        font-weight: bolder;
      }

      p {
        max-width: 38ch;
        margin-block: 1rem;
      }

      .spacer {
        margin-bottom: 4rem;
      }

      a {
        color: inherit;
      }

      button {
        padding: 0 2rem;
        appearance: none;
        background-color: var(--foreground-color);
        color: var(--background-color);
        font-size: 1.2rem;
        border: 0;
        height: 3rem;
        border-radius: 1.5rem;
        cursor: pointer;
      }

      .attendance-button--attending::after {
        content: "✔";
        animation: check 0.1s ease-in-out;
      }

      @keyframes check {
        0% {
          clip-path: inset(0 100% 0 0);
        }
        100% {
          clip-path: inset(0);
        }
      }

      .link-list {
        font-size: 0.9em;
        list-style: none;
        padding: 0;
        display: flex;
        gap: 1rem;
      }
    </style>
  </head>

  <body>
    <main>
      <h1 class="spacer">Vienna Climate Action Tech Meetup #1</h1>
      <p class="spacer">
        Join us if you'd like to talk about climate and tech. Whether it's
        <a href="https://climateaction.tech/about/">
          making tech greener or using tech to accelerate climate action. </a
        ><br />
        Also if you really like fast and sustainable websites.
      </p>

      <p>
        <strong>Where:</strong>
        <a href="https://www.gbstern.at/themen-projekte/stadtraum-mitte-15/">
          Am Rustensteg 1, 1150 Wien
        </a>
      </p>
      <p class="spacer"><strong>When:</strong> 12.7. – 18:30</p>

      <p>Let us know if you're coming:</p>
      <p>
        <button class="attendance-button" id="attendanceButton">
          I'm attending
        </button>
      </p>
    </main>
    <footer>
      <ul class="link-list">
        <li>
          <a href="https://github.com/climateaction-tech/codeofconduct">
            Code of conduct
          </a>
        </li>
        <li>
          <a href="https://ganslandt.xyz/imprint/"> Imprint </a>
        </li>
      </ul>
    </footer>
  </body>

  <script>
    const button = document.getElementById("attendanceButton");
    const ATTENDING_CLASS = "attendance-button--attending";
    const ATTENDING_STORAGE_KEY = "attending-1";
    const API_KEY =
      "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InN4aGR3ZWlqY3Jybndkc3J6dHh4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE2ODY3MjU2NTUsImV4cCI6MjAwMjMwMTY1NX0.PBwAKif0eTkme_8dJpfxFAUYAKFyflCFiyQTRBLsFME";
    const FETCH_OPTIONS = {
      method: "POST",
      headers: {
        Apikey: API_KEY,
        Authorization: `Bearer ${API_KEY}`,
      },
    };

    function isAttending() {
      return localStorage.getItem(ATTENDING_STORAGE_KEY) === "true";
    }

    if (isAttending()) button.classList.add(ATTENDING_CLASS);

    button.addEventListener("click", () => {
      button.classList.toggle(ATTENDING_CLASS);

      if (isAttending()) {
        fetch(
          "https://sxhdweijcrrnwdsrztxx.supabase.co/rest/v1/rpc/decrement_by_one",
          FETCH_OPTIONS
        ).then(() => {
          localStorage.setItem(ATTENDING_STORAGE_KEY, false);
        });
      } else {
        fetch(
          "https://sxhdweijcrrnwdsrztxx.supabase.co/rest/v1/rpc/increment_by_one",
          FETCH_OPTIONS
        ).then(() => {
          localStorage.setItem(ATTENDING_STORAGE_KEY, true);
        });
      }
    });
  </script>
</html>
